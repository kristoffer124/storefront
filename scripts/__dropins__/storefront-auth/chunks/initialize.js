/*! Copyright 2025 Adobe
All Rights Reserved. */
import{Initializer as s}from"@dropins/tools/lib.js";import{a as f,d as c}from"./getStoreConfig.js";import{events as u}from"@dropins/tools/event-bus.js";import"@dropins/tools/recaptcha.js";import{a as h,f as d,r as m}from"./network-error.js";const r=new s({init:async e=>{const t={...{authHeaderConfig:{header:"Authorization",tokenPrefix:"Bearer"}},...e};r.config.setConfig(t),g(t.authHeaderConfig)},listeners:()=>[]});function g(e){const i=f("auth_dropin_user_token");i&&(h(e.header,`${e.tokenPrefix} ${i}`),d("query VALIDATE_TOKEN{ customerCart { id } }").then(t=>{var o;(o=t.errors)!=null&&o.find(a=>{var n;return((n=a.extensions)==null?void 0:n.category)==="graphql-authentication"})&&(c("auth_dropin_user_token"),m("Authorization"),u.emit("authenticated",!1))}))}const y=r.config;export{y as c,r as i};
